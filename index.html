
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>SquareLemon</title>
	<meta name="author" content="Lee Brotherson">

	
	<meta name="description" content="Last year I gave my Corporation In The Middle talk in which I explained how my ISP has been man-in-the-middle&#8217;ing my connection to inject a &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="SquareLemon" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
</head>

<body>
	<div class="container">	

			<div class="mid-col-container">
				<div id="content" class="inner">
					


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2015-01-27T09:33:16-05:00" pubdate data-updated="true">Jan 27<span>th</span>, 2015</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2015/01/27/citm-snort-rules/">Snort Rules - CitM</a></h1>
	<div class="entry-content">
		<p>Last year I gave my Corporation In The Middle talk in which I explained how my ISP has been man-in-the-middle&#8217;ing my connection to inject a warning banner into the top of webpages I visited (talk content <a href="blog.squarelemon.com/blog/2014/10/29/corporation-in-the-middle/">here</a> and <a href="http://blog.squarelemon.com/blog/2014/12/29/bsides-toronto-video-and-slides/">here</a>).</p>

<p>Part of this involved traffic analysis to discover artifacts of the injection process.  In an effort to make this process more automated, repeatable and accessible I have put together a few snort rules to allow others to alert on this condition:<br /></p>

<p><a href="https://github.com/LeeBrotherston/snort"><a href="https://github.com/LeeBrotherston/snort">https://github.com/LeeBrotherston/snort</a></a><br /></p>

<p>One rule is commented out as it is noisy and prone to false positives, however I have included it (disabled) for now, for reference.  The other three rules have been tested by me on my personal environment and seem to be free from false positives, however this is only a limited test and so feedback would be really appreciated from anyone running them elsewhere.<br /></p>

<p>Of course these are far from complete in terms of detection of man in the middle generically, they only pertain to the specific technique outlined in my talk, however I will endeavour to update them as I obtain further information.</p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2015-01-04T23:38:11-05:00" pubdate data-updated="true">Jan 4<span>th</span>, 2015</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2015/01/04/mitm-at-30/">MiTM at 30,000 Feet</a></h1>
	<div class="entry-content">
		<p>In the past week I have seen a few mentions on twitter regarding <a href="http://twitter.com/gogo">Gogo Air</a> presenting fake SSL certs for YouTube to users of their in air Internet access service:<br />
		
		<a href="/blog/2015/01/04/mitm-at-30/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2015-01-02T10:00:00-05:00" pubdate data-updated="true">Jan 2<span>nd</span>, 2015</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2015/01/02/no-we-dont/">No We Don&#8217;t</a></h1>
	<div class="entry-content">
		<p>I just got a festive present from my ISP, <a href="http://www.rogers.com">Rogers</a>.<br /><br /></p>

<p>Following my <a href="http://blog.squarelemon.com/blog/2014/10/29/corporation-in-the-middle/">recent <a href="http://blog.squarelemon.com/blog/2014/12/24/bsides-toronto-video-and-slides/">talks</a> regarding ISP packet injection/interception and data collection I wrote to the privacy officer at Rogers and asked, under PIPEDA, that I be supplied all information regarding my account, including any information that they have gathered such as URLs of sites visited, etc.<br /></p>

<br />


<p>I got a fairly standard response which said that they did not collect any such data, to which I replied:
		
		<a href="/blog/2015/01/02/no-we-dont/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-12-29T11:59:00-05:00" pubdate data-updated="true">Dec 29<span>th</span>, 2014</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2014/12/29/bsides-toronto-video-and-slides/">BSides Toronto Video &amp; Slides</a></h1>
	<div class="entry-content">
		<p>At the end of November I gave my talk, &ldquo;Corporation In The Middle [BSidesTO Edition]&rdquo; at <a href="http://bsidesto.ca">BSides Toronto 2014</a>.</p>

<br />


<p>The recording of the talk is now online and available here:<br /></p>

<iframe width="560" height="315" src="//www.youtube.com/embed/_YeaYIPM-QI" frameborder="0" allowfullscreen></iframe>


<br />


<p>You can play along at home with the slides, here:<br /></p>

<iframe src="//www.slideshare.net/slideshow/embed_code/41918170" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>


<p> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/LeeBrotherston/corporation-in-the-middle-bsidesto-edition" title="Corporation In The Middle - BSidesTO Edition" target="_blank">Corporation In The Middle &ndash; BSidesTO Edition</a> </strong> from <strong><a href="//www.slideshare.net/LeeBrotherston" target="_blank">Lee Brotherston</a></strong> </div></p>

<br />


		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-10-29T22:59:58-04:00" pubdate data-updated="true">Oct 29<span>th</span>, 2014</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2014/10/29/corporation-in-the-middle/">Corporation in the Middle</a></h1>
	<div class="entry-content">
		<p>A few days ago I presented my talk, &ldquo;Corporation In The Middle&rdquo; at <a href="http://sector.ca">SecTor 2014</a>.  I will be presenting an updated and truncated version of the talk at <a href="http://www.bsidesto.ca/">BSides Toronto</a> in November of this year.</p>

<p>If you are interested in seeing the talk you can do so here:</p>

<iframe src="//player.vimeo.com/video/110367213" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>


<br />


<p>If so inclined, you can also <a href="http://www.slideshare.net/LeeBrotherston/lee-brotherston-corporation-in-the-middle">get the slides here</a>.</p>

<br />


<p>The original blurb was:
<i>My ISP deliberately MiTM&rsquo;d my connection.  This talk discusses how they did it, how I detected what they did and what this means.  This talk covers what I learnt over three months of analysis focusing on the technology involved both on the ISP side and my own. I cover in detail how I went about identifying and mapping the ISPs hidden network components and how they modify IP connections. I will briefly cover what this means to customers of their service.  During the talk I will provide technical evidence as well as walk through how I used open source tools to unmask this Corp In The Middle attack.
</i></p>

		
		
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-07-18T09:55:44-04:00" pubdate data-updated="true">Jul 18<span>th</span>, 2014</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2014/07/18/is-your-eula-lowering-your-application-security/">Is Your EULA Lowering Your Application Security?</a></h1>
	<div class="entry-content">
		<p>A couple of days ago I tweeted this:</p>

<center>
<blockquote class="twitter-tweet" lang="en"><p>I&#39;m pretty sure when your EULA prohibits reverse engineering your software, all you prevent is people telling you that they reversed it.</p>&mdash; leE Brotherston (@leEb_public) <a href="https://twitter.com/leEb_public/statuses/489050821649506304">July 15, 2014</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>


<p>Quite a lot of people agreed (at the time of writing it has 40 retweets and 19 favourites, which is quite a lot for me), so I thought that I would expand and explain this in a little more detail.
		
		<a href="/blog/2014/07/18/is-your-eula-lowering-your-application-security/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post">
	<div class="meta">
		<div class="date">








  


<time datetime="2014-05-24T23:42:56-04:00" pubdate data-updated="true">May 24<span>th</span>, 2014</time></div>
		
	</div>
	<h1 class="title"><a href="/blog/2014/05/24/sector-2014/">SecTor 2014</a></h1>
	<div class="entry-content">
		<p>I was meant to start this blog with a post about my ISP, about how they had man in the middle&rsquo;d my connection and how I had been working out the details of why they had been doing this, how they achieved it and how I uncovered what they had been up to.</p>

<p>Since I started writing that post the topic has grown somewhat and now I have been confirmed as a <a href="http://sector.ca/Program/Sessions/Session-Details/evl/0/tag/16752/Lee-Brotherston">speaker at SecTor 2014</a> in Toronto.</p>

<p>So, the post is still coming&hellip;  But if you want to see me explain it in as much Powerpoint glory as I can muster, come on down to SecTor later this year :)</p>

<p>Edit: If you want a 10% discount on full conference entry use the code: SecTorSpeaker2014</p>

		
		
	</div>

</article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
				</div>
			</div>
			<footer id="footer" class="inner">
				<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a> - 

    <a href="/about">Lee Brotherson</a>
 |
</footer>
			<script src="/javascripts/slash.js"></script>





	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-54930700-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




	</div>
</body>
</html>
